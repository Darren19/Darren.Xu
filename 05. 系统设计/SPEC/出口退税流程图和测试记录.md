```flow
开始=>start: 开始
发票=>operation: 发票
出口退税记录=>operation: 出口退税记录
货品收据=>operation: 货品收据（入库单价，计算预估退税金额）
账单=>operation: 账单（发票单价，计算实际退税金额）
后到账单=>operation: 账单
匹配出口退税=>operation: 匹配出口退税（匹配发票单价，更新实际退税金额）
出口退税日记账=>operation: 出口退税日记账
调整出口退税=>operation: 调整出口退税
退税成本日记账=>operation: 退税成本日记账
红冲日记账=>operation: 红冲日记账
标记已调整=>operation: 标记已调整
标记未调整=>operation: 标记未调整
已开账单=>condition: 已开账单
有发票号=>condition: 有发票号
结束=>end: 结束

开始->货品收据->已开账单
已开账单(yes)->账单->发票
已开账单(no)->匹配出口退税->发票
发票->出口退税记录->出口退税日记账->有发票号
有发票号(yes)->退税成本日记账->标记已调整
有发票号(no)->标记未调整(right)->调整出口退税(right)->红冲日记账(right)->出口退税日记账
```

# 出口退税测试记录

发票链接为：https://5151251-sb1.app.netsuite.com/app/accounting/transactions/custinvc.nl?id=9251000&whence=&cmid=1574479774054_4561

共有2个批次，2019102301和2019102302。

## 账单在发票之前

2019102301，这个批次的账单在发票之前。

它的账单链接为：https://5151251-sb1.app.netsuite.com/app/accounting/transactions/vendbill.nl?id=9250996&whence=

## 账单在发票之后

2019102302，这个批次的账单在发票之后。

它的采购订单链接为：https://5151251-sb1.app.netsuite.com/app/accounting/transactions/purchord.nl?id=9250997&whence=

它的货品收据链接为：https://5151251-sb1.app.netsuite.com/app/accounting/transactions/itemrcpt.nl?id=9250998&whence=

每次测试时，需要手工创建账单。

