# 出口退税测试记录

**不免税的情况下，是无法完成退税的，所以不免只退这种业务场景不存在，可以不用测试。**

发票链接为：https://5151251-sb1.app.netsuite.com/app/accounting/transactions/custinvc.nl?id=10500263&whence=

共有2个批次，20191201和20191202。

## 账单在发票之前

20191201，这个批次的账单在发票之前。

它的账单链接为：https://5151251-sb1.app.netsuite.com/app/accounting/transactions/vendbill.nl?id=10499962&whence=&cmid=1575857638649_778

要记录部门、地点和类字段，并同步到日记账记录上；

1. 第1条记录先测试免税且退税的情形；再测试免税不退税的情形，需要修改实际退税率为0%；
2. 第2条记录测试不免税不退税，需要修改销售税率为13%，勾选不免税，修实际退税率为0%；

## 账单在发票之后

20191202，这个批次的账单在发票之后。

它的采购订单链接为：https://5151251-sb1.app.netsuite.com/app/accounting/transactions/purchord.nl?id=10499860&whence=&cmid=1575857208840_748

它的货品收据链接为：https://5151251-sb1.app.netsuite.com/app/accounting/transactions/itemrcpt.nl?id=10499961&whence=&cmid=1575857480407_767

每次测试时，需要手工创建账单。

使用第3条记录，发票匹配之后测试以下3种情况：

1. 又免又退；
2. 只免不退；
3. 不免不退；



要考虑发票汇率，出口通常是美金；汇率保留4位小数；单价保留原来的小数位，可能是6位，也有可能是8位；金额保留2位即可；

实际退税金额和未退税金额取的是预估金额，而不是实际金额；https://5151251-sb1.app.netsuite.com/app/common/custom/custrecordentry.nl?rectype=296&id=44

调整出口退税日记账生成时报错；

单据保存完之后，需要根据税率重新计算，使用工作流；